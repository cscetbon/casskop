"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[8715],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>f});var r=a(7294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},s=Object.keys(e);for(r=0;r<s.length;r++)a=s[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)a=s[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var i=r.createContext({}),u=function(e){var t=r.useContext(i),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},c=function(e){var t=u(e.components);return r.createElement(i.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,s=e.originalType,i=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),p=u(a),m=n,f=p["".concat(i,".").concat(m)]||p[m]||d[m]||s;return a?r.createElement(f,o(o({ref:t},c),{},{components:a})):r.createElement(f,o({ref:t},c))}));function f(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var s=a.length,o=new Array(s);o[0]=m;var l={};for(var i in t)hasOwnProperty.call(t,i)&&(l[i]=t[i]);l.originalType=e,l[p]="string"==typeof e?e:n,o[1]=l;for(var u=2;u<s;u++)o[u]=a[u];return r.createElement.apply(null,o)}return r.createElement.apply(null,a)}m.displayName="MDXCreateElement"},5162:(e,t,a)=>{a.d(t,{Z:()=>o});var r=a(7294),n=a(6010);const s={tabItem:"tabItem_Ymn6"};function o(e){let{children:t,hidden:a,className:o}=e;return r.createElement("div",{role:"tabpanel",className:(0,n.Z)(s.tabItem,o),hidden:a},t)}},4866:(e,t,a)=>{a.d(t,{Z:()=>w});var r=a(7462),n=a(7294),s=a(6010),o=a(2466),l=a(6550),i=a(1980),u=a(7392),c=a(12);function p(e){return function(e){return n.Children.map(e,(e=>{if((0,n.isValidElement)(e)&&"value"in e.props)return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))}(e).map((e=>{let{props:{value:t,label:a,attributes:r,default:n}}=e;return{value:t,label:a,attributes:r,default:n}}))}function d(e){const{values:t,children:a}=e;return(0,n.useMemo)((()=>{const e=t??p(a);return function(e){const t=(0,u.l)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,a])}function m(e){let{value:t,tabValues:a}=e;return a.some((e=>e.value===t))}function f(e){let{queryString:t=!1,groupId:a}=e;const r=(0,l.k6)(),s=function(e){let{queryString:t=!1,groupId:a}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!a)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return a??null}({queryString:t,groupId:a});return[(0,i._X)(s),(0,n.useCallback)((e=>{if(!s)return;const t=new URLSearchParams(r.location.search);t.set(s,e),r.replace({...r.location,search:t.toString()})}),[s,r])]}function h(e){const{defaultValue:t,queryString:a=!1,groupId:r}=e,s=d(e),[o,l]=(0,n.useState)((()=>function(e){let{defaultValue:t,tabValues:a}=e;if(0===a.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!m({value:t,tabValues:a}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${a.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const r=a.find((e=>e.default))??a[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:t,tabValues:s}))),[i,u]=f({queryString:a,groupId:r}),[p,h]=function(e){let{groupId:t}=e;const a=function(e){return e?`docusaurus.tab.${e}`:null}(t),[r,s]=(0,c.Nk)(a);return[r,(0,n.useCallback)((e=>{a&&s.set(e)}),[a,s])]}({groupId:r}),b=(()=>{const e=i??p;return m({value:e,tabValues:s})?e:null})();(0,n.useLayoutEffect)((()=>{b&&l(b)}),[b]);return{selectedValue:o,selectValue:(0,n.useCallback)((e=>{if(!m({value:e,tabValues:s}))throw new Error(`Can't select invalid tab value=${e}`);l(e),u(e),h(e)}),[u,h,s]),tabValues:s}}var b=a(2389);const g={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};function k(e){let{className:t,block:a,selectedValue:l,selectValue:i,tabValues:u}=e;const c=[],{blockElementScrollPositionUntilNextRender:p}=(0,o.o5)(),d=e=>{const t=e.currentTarget,a=c.indexOf(t),r=u[a].value;r!==l&&(p(t),i(r))},m=e=>{let t=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const a=c.indexOf(e.currentTarget)+1;t=c[a]??c[0];break}case"ArrowLeft":{const a=c.indexOf(e.currentTarget)-1;t=c[a]??c[c.length-1];break}}t?.focus()};return n.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.Z)("tabs",{"tabs--block":a},t)},u.map((e=>{let{value:t,label:a,attributes:o}=e;return n.createElement("li",(0,r.Z)({role:"tab",tabIndex:l===t?0:-1,"aria-selected":l===t,key:t,ref:e=>c.push(e),onKeyDown:m,onClick:d},o,{className:(0,s.Z)("tabs__item",g.tabItem,o?.className,{"tabs__item--active":l===t})}),a??t)})))}function y(e){let{lazy:t,children:a,selectedValue:r}=e;if(a=Array.isArray(a)?a:[a],t){const e=a.find((e=>e.props.value===r));return e?(0,n.cloneElement)(e,{className:"margin-top--md"}):null}return n.createElement("div",{className:"margin-top--md"},a.map(((e,t)=>(0,n.cloneElement)(e,{key:t,hidden:e.props.value!==r}))))}function v(e){const t=h(e);return n.createElement("div",{className:(0,s.Z)("tabs-container",g.tabList)},n.createElement(k,(0,r.Z)({},e,t)),n.createElement(y,(0,r.Z)({},e,t)))}function w(e){const t=(0,b.Z)();return n.createElement(v,(0,r.Z)({key:String(t)},e))}},7074:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>i,contentTitle:()=>o,default:()=>d,frontMatter:()=>s,metadata:()=>l,toc:()=>u});var r=a(7462),n=(a(7294),a(3905));a(4866),a(5162);const s={title:"Getting Started",sidebar_label:"Getting Started"},o=void 0,l={unversionedId:"setup/getting_started",id:"setup/getting_started",title:"Getting Started",description:"CassKop uses the standard Cassandra image (tested up to Version 3.11), and can run on Kubernetes 1.13.3+.",source:"@site/docs/2_setup/1_getting_started.md",sourceDirName:"2_setup",slug:"/setup/getting_started",permalink:"/casskop/docs/setup/getting_started",draft:!1,editUrl:"https://github.com/cscetbon/casskop/edit/master/website/docs/2_setup/1_getting_started.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{title:"Getting Started",sidebar_label:"Getting Started"},sidebar:"docs",previous:{title:"Design Principes",permalink:"/casskop/docs/concepts/design_principes"},next:{title:"Install Plugin",permalink:"/casskop/docs/setup/install_plugin"}},i={},u=[{value:"CassKop deployment",id:"casskop-deployment",level:2},{value:"Kubernetes preparation",id:"kubernetes-preparation",level:3},{value:"Installing CassKop with Helm 3",id:"installing-casskop-with-helm-3",level:3},{value:"Deploy a Cassandra cluster",id:"deploy-a-cassandra-cluster",level:3},{value:"Deploy a ConfigMap",id:"deploy-a-configmap",level:4},{value:"Deploy CassandraCluster resource",id:"deploy-cassandracluster-resource",level:4},{value:"Monitoring",id:"monitoring",level:3},{value:"Deploy Prometheus",id:"deploy-prometheus",level:4},{value:"Add ServiceMonitor for Cassandra",id:"add-servicemonitor-for-cassandra",level:4},{value:"Add Grafana dashboard for Cassandra",id:"add-grafana-dashboard-for-cassandra",level:4}],c={toc:u},p="wrapper";function d(e){let{components:t,...a}=e;return(0,n.kt)(p,(0,r.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("p",null,"CassKop uses the standard Cassandra image (tested up to Version 3.11), and can run on Kubernetes 1.13.3+."),(0,n.kt)("p",null,"As a pre-requisite it needs :"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://kubernetes.io/docs/tasks/tools/install-kubectl/"},"kubectl")," version v1.13.3+."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://helm.sh/"},"Helm")," version v3."),(0,n.kt)("li",{parentName:"ul"},"Access to a Kubernetes v1.13.3+ cluster."),(0,n.kt)("li",{parentName:"ul"},"Cassandra needs fast local storage (we have tested with local storage provisioner, GKE ssd storage, and Rancher local-path-provisioner). Fast remote storage should work but is not tested yet.")),(0,n.kt)("h2",{id:"casskop-deployment"},"CassKop deployment"),(0,n.kt)("h3",{id:"kubernetes-preparation"},"Kubernetes preparation"),(0,n.kt)("p",null,"First, we need to create a ",(0,n.kt)("inlineCode",{parentName:"p"},"namespace")," in order to host our operator & cluster (here we call it cassandra)"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl create namespace cassandra\n")),(0,n.kt)("h3",{id:"installing-casskop-with-helm-3"},"Installing CassKop with Helm 3"),(0,n.kt)("p",null,"You can (should) deploy CassKop using this ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/Orange-Opensource/casskop/tree/master/helm"},"Helm 3 chart"),":"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"helm install casskop oci://ghcr.io/cscetbon/casskop-helm\n")),(0,n.kt)("p",null,"You can find more information in the ",(0,n.kt)("a",{parentName:"p",href:"/casskop/docs/configuration_deployment/customizable_install_with_helm"},"Customizable install with helm"),"."),(0,n.kt)("p",null,"If you have problem you can see ",(0,n.kt)("a",{parentName:"p",href:"/casskop/docs/troubleshooting/operations_issues"},"Troubleshooting")," section"),(0,n.kt)("h3",{id:"deploy-a-cassandra-cluster"},"Deploy a Cassandra cluster"),(0,n.kt)("h4",{id:"deploy-a-configmap"},"Deploy a ConfigMap"),(0,n.kt)("p",null,"Before we can deploy our cluster, we need to create a configmap.\nThis configmap will enable us to customize Cassandra's behaviour.\nMore details on this can be found ",(0,n.kt)("a",{parentName:"p",href:"/casskop/docs/configuration_deployment/cassandra_configuration#configuration-override-using-configmap"},"here")),(0,n.kt)("p",null,"But for our example we will use the simple example:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl apply -f config/samples/cassandra-configmap-v1.yaml\n")),(0,n.kt)("h4",{id:"deploy-cassandracluster-resource"},"Deploy CassandraCluster resource"),(0,n.kt)("p",null,"Once the operator is deployed inside a Kubernetes cluster, a new API will be accessible, so\nyou'll be able to create, update and delete cassandraclusters."),(0,n.kt)("p",null,"In order to deploy a new cassandra cluster a ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/cscetbon/casskop/blob/master/config/samples/cassandracluster.yaml"},"specification")," has to be created. As an example :"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl apply -f config/samples/cassandracluster.yaml\n")),(0,n.kt)("h3",{id:"monitoring"},"Monitoring"),(0,n.kt)("p",null,"We can quickly setup monitoring for our deployed Cassandra nodes using\nPrometheus operator."),(0,n.kt)("h4",{id:"deploy-prometheus"},"Deploy Prometheus"),(0,n.kt)("p",null,"You can deploy the CoreOs Prometheus operator on your cluster:\nYou can find example ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/cscetbon/casskop/blob/master/config/samples/prometheus-values.yaml"},"helm value.yaml")," to configure the Prometheus operator:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-console"},'kubectl create namespace monitoring\nhelm install --namespace monitoring prometheus-monitoring stable/prometheus-operator \\\n    --set prometheusOperator.createCustomResource=false \\\n    --set grafana.image.tag=7.0.1 \\\n    --set grafana.plugins="{briangann-gauge-panel,grafana-clock-panel,grafana-piechart-panel,grafana-polystat-panel,savantly-heatmap-panel,vonage-status-panel}"\n')),(0,n.kt)("h4",{id:"add-servicemonitor-for-cassandra"},"Add ServiceMonitor for Cassandra"),(0,n.kt)("p",null,"Then you have to create ServiceMonitor objects to monitor Cassandra nodes and CassKop. You can update this to specify\nwhich namespace to monitor (Your namespace need to be listed in the ",(0,n.kt)("inlineCode",{parentName:"p"},"namespaceSelector")," section.)"),(0,n.kt)("p",null,(0,n.kt)("inlineCode",{parentName:"p"},"kubectl  apply -f monitoring/servicemonitor/")),(0,n.kt)("h4",{id:"add-grafana-dashboard-for-cassandra"},"Add Grafana dashboard for Cassandra"),(0,n.kt)("p",null,"You can use our dashboard that monitors both Cassandra nodes and CassKop by running:\n",(0,n.kt)("inlineCode",{parentName:"p"},"kubectl  apply -f monitoring/dashboards/")))}d.isMDXComponent=!0}}]);